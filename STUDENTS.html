<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ | Ù…Ù†ØµØ© ÙƒÙ„ÙŠØ© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Cairo', Arial, sans-serif;
        margin: 0;
        background: linear-gradient(135deg, #e0e7ff 0%, #f1f5f9 100%);
        color: #222;
        min-height: 100vh;
      }
      header {
        background: linear-gradient(90deg, #2563eb 60%, #1e40af 100%);
        color: white;
        padding: 35px 0 25px 0;
        text-align: center;
        border-radius: 0 0 30px 30px;
        box-shadow: 0 4px 16px rgba(30,64,175,0.08);
      }
      header h1 {
        font-size: 2.2rem;
        margin: 0 0 10px 0;
        letter-spacing: 1px;
      }
      nav {
        background: #e0e7ff;
        border-bottom: 2px solid #2563eb;
        padding: 0;
        margin-bottom: 0;
        text-align: center;
      }
      nav a {
        text-decoration: none;
        color: #1e40af;
        font-weight: bold;
        font-size: 1.15rem;
        padding: 14px 22px;
        border-radius: 8px 8px 0 0;
        transition: background 0.2s, color 0.2s;
        display: inline-block;
        margin: 0 5px;
      }
      nav a:hover, nav a.active {
        background: #2563eb;
        color: #fff;
      }
      main {
        max-width: 1000px;
        margin: 40px auto 0 auto;
        background: #fff;
        padding: 35px 25px;
        border-radius: 18px;
        box-shadow: 0 6px 24px rgba(30,64,175,0.07);
      }
      h2 {
        color: #2563eb;
        text-align: center;
        margin-bottom: 25px;
        font-size: 1.4rem;
      }
      .search-bar {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        margin-bottom: 25px;
        margin-top: 10px;
        position: relative;
      }
      .search-bar input[type="text"] {
        padding: 12px;
        border-radius: 8px;
        border: 1.5px solid #bfc9d9;
        font-size: 1.08rem;
        min-width: 220px;
        outline: none;
        transition: border 0.2s;
        text-align: center;
        background: #f9fafb;
      }
      .search-bar input[type="text"]:focus {
        border: 1.5px solid #2563eb;
        background: #fff;
      }
      .search-bar button {
        background: linear-gradient(90deg, #2563eb 60%, #1e40af 100%);
        color: white;
        padding: 10px 28px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1.08rem;
        font-family: inherit;
        font-weight: bold;
        transition: background 0.2s;
      }
      .search-bar button:hover {
        background: #1e40af;
      }
      .search-suggestions {
        position: absolute;
        top: 48px;
        right: 0;
        left: 0;
        background: #fff;
        border: 1px solid #bfc9d9;
        border-radius: 0 0 10px 10px;
        z-index: 10;
        max-height: 180px;
        overflow-y: auto;
        box-shadow: 0 4px 16px rgba(30,64,175,0.08);
        display: none;
      }
      .search-suggestions li {
        padding: 10px 18px;
        cursor: pointer;
        font-size: 1.05rem;
        color: #1e40af;
        transition: background 0.15s;
        text-align: right;
      }
      .search-suggestions li:hover, .search-suggestions li.active {
        background: #e0e7ff;
        color: #2563eb;
      }
      .search-result {
        text-align: center;
        margin-bottom: 18px;
        font-size: 1.15rem;
        color: #2563eb;
        font-weight: bold;
        background: #e0e7ff;
        border-radius: 10px;
        padding: 10px 0;
        display: none;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background: #f9fafb;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 10px rgba(30,64,175,0.05);
      }
      th, td {
        border: 1px solid #e5e7eb;
        padding: 10px 8px;
        text-align: center;
        font-size: 1.08rem;
      }
      th {
        background-color: #2563eb;
        color: white;
        font-size: 1.1rem;
        letter-spacing: 1px;
      }
      tr:nth-child(even) {
        background: #e0e7ff;
      }
      .highlight {
        background: #fef08a !important;
        color: #b45309 !important;
        font-weight: bold;
      }
      .edit-btn, .delete-btn, .semesters-btn {
        background: #2563eb;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 6px 14px;
        margin: 0 2px;
        font-size: 0.95rem;
        cursor: pointer;
        transition: background 0.2s;
      }
      .edit-btn:hover, .semesters-btn:hover {
        background: #1e40af;
      }
      .delete-btn {
        background: #e67e22;
      }
      .delete-btn:hover {
        background: #ba7b16;
      }
      .semesters-btn {
        background: #16a34a;
        font-size: 1.1em;
        padding: 6px 10px;
      }
      .no-data {
        color: #e74c3c;
        font-size: 1.1rem;
        text-align: center;
      }
      .btn-export {
        background: #16a34a;
        color: white;
        padding: 10px 22px;
        border-radius: 8px;
        border: none;
        font-size: 1rem;
        margin: 18px 5px 0 5px;
        cursor: pointer;
        transition: background 0.2s;
        font-family: inherit;
        font-weight: bold;
      }
      .btn-export:hover {
        background: #166534;
      }
      .stat-bar {
        margin: 30px 0 10px 0;
        display: flex;
        justify-content: center;
        gap: 18px;
        flex-wrap: wrap;
      }
      .stat-box {
        background-color: #e0e7ff;
        padding: 18px 14px;
        border-radius: 12px;
        min-width: 140px;
        max-width: 200px;
        text-align: center;
        box-shadow: 0 2px 8px rgba(30,64,175,0.04);
        margin-bottom: 10px;
      }
      .stat-box h3 {
        color: #2980b9;
        margin-bottom: 8px;
        font-size: 1.05rem;
      }
      /* Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØµÙˆÙ„ */
      #semestersModal {
        position: fixed;
        inset: 0;
        background: rgba(30,64,175,0.85);
        z-index: 10010;
        display: none;
        align-items: center;
        justify-content: center;
      }
      .semesters-box {
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 6px 24px rgba(30,64,175,0.18);
        padding: 35px 25px 25px 25px;
        text-align: center;
        min-width: 320px;
        max-width: 95vw;
        position: relative;
      }
      .semesters-box h3 {
        color: #2563eb;
        margin-bottom: 18px;
        font-size: 1.2rem;
      }
      .semesters-list {
        margin-bottom: 18px;
      }
      .semesters-list input[type="number"] {
        width: 80px;
        padding: 7px;
        border-radius: 7px;
        border: 1px solid #bfc9d9;
        margin: 0 6px;
        font-size: 1rem;
        text-align: center;
      }
      .semesters-list label {
        margin-left: 8px;
        font-weight: bold;
        color: #1e40af;
      }
      .semesters-box .save-btn {
        background: #2563eb;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 10px 26px;
        font-size: 1.1rem;
        margin: 0 5px;
        cursor: pointer;
        transition: background 0.2s;
      }
      .semesters-box .save-btn:hover {
        background: #1e40af;
      }
      .semesters-box .close-btn {
        background: #e74c3c;
        color: #fff;
        border-radius: 8px;
        padding: 7px 18px;
        font-size: 1rem;
        margin-top: 10px;
        border: none;
        cursor: pointer;
      }
      .semesters-box .close-btn:hover {
        background: #c0392b;
      }
      .semesters-box .final-gpa {
        margin-top: 15px;
        font-size: 1.1rem;
        color: #16a34a;
        font-weight: bold;
      }
      @media (max-width: 700px) {
        main { padding: 10px 2px; }
        th, td { font-size: 0.95rem; }
        h2 { font-size: 1.1rem; }
        .stat-bar { flex-direction: column; gap: 10px; }
        .semesters-box { min-width: 90vw; }
        .search-bar input[type="text"] { min-width: 120px; }
      }
    </style>
</head>
<body>
  <header>
    <h1>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
  </header>
  <nav>
      <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="students.html" class="active">Ø§Ù„Ø·Ù„Ø§Ø¨</a>
      <a href="analytics.html">Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</a>
      <a href="reports.html">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
      <a href="comparison.html">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„ØªØ®ØµØµØ§Øª</a>
  </nav>
  <main>
    <h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø¶Ø§ÙÙŠÙ†</h2>
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨..." autocomplete="off" oninput="showSuggestions()">
      <button onclick="searchStudent()">Ø¨Ø­Ø«</button>
      <ul class="search-suggestions" id="searchSuggestions"></ul>
    </div>
    <div class="search-result" id="searchResult"></div>
    <div class="stat-bar" id="statBar"></div>
    <button class="btn-export" onclick="exportCSV()">ØªØµØ¯ÙŠØ± ÙƒÙ€ CSV</button>
    <table>
      <thead>
        <tr>
          <th>Ø§Ù„Ø±Ù‚Ù…</th>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th>Ø§Ù„ØªØ®ØµØµ</th>
          <th>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th>
          <th>Ø§Ù„ÙØµÙˆÙ„</th>
          <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
      </thead>
      <tbody id="studentsTableBody">
        <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† LocalStorage -->
      </tbody>
    </table>
  </main>

  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØµÙˆÙ„ -->
  <div id="semestersModal">
    <div class="semesters-box">
      <h3>Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„ÙØµÙˆÙ„ Ù„Ù„Ø·Ø§Ù„Ø¨: <span id="modalStudentName"></span></h3>
      <form id="semestersForm">
        <div class="semesters-list" id="semestersInputs"></div>
        <div class="final-gpa" id="finalGpaText"></div>
        <button type="submit" class="save-btn">Ø­ÙØ¸</button>
        <button type="button" class="close-btn" onclick="closeSemestersModal()">Ø¥ØºÙ„Ø§Ù‚</button>
      </form>
    </div>
  </div>

  <footer>
    &copy; 2025 Ù…Ù†ØµØ© ÙƒÙ„ÙŠØ© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
  </footer>
  <script>
    // --- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„ÙØµÙˆÙ„ ---
    function getStudents() {
      return JSON.parse(localStorage.getItem('studentsData') || '[]');
    }
    function setStudents(data) {
      localStorage.setItem('studentsData', JSON.stringify(data));
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø¹ Ø²Ø± Ø§Ù„ÙØµÙˆÙ„
    function renderTable(highlightName = null) {
      const students = getStudents();
      const tbody = document.getElementById('studentsTableBody');
      tbody.innerHTML = '';
      if (!students.length) {
        tbody.innerHTML = `<tr><td colspan="6" class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</td></tr>`;
      } else {
        students.forEach((s, i) => {
          const highlight = highlightName && s.name === highlightName ? 'highlight' : '';
          tbody.innerHTML += `
            <tr class="${highlight}">
              <td>${i + 1}</td>
              <td>${s.name}</td>
              <td>${s.major}</td>
              <td>${s.gpa}</td>
              <td>
                <button class="semesters-btn" title="Ø¹Ø±Ø¶/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙØµÙˆÙ„" onclick="showSemestersModalByName('${s.name.replace(/'/g,"\\'")}')">ğŸ“š</button>
              </td>
              <td>
                <button class="edit-btn" onclick="editStudentByName('${s.name.replace(/'/g,"\\'")}')">ØªØ¹Ø¯ÙŠÙ„</button>
                <button class="delete-btn" onclick="deleteStudentByName('${s.name.replace(/'/g,"\\'")}')">Ø­Ø°Ù</button>
              </td>
            </tr>
          `;
        });
      }
    }

    // Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨ Ø¨Ø§Ù„Ø§Ø³Ù… Ù…Ø¹ ØªÙ‚Ø±ÙŠØ¨ (Ø¨Ø­Ø« Ø¬Ø²Ø¦ÙŠ ÙˆÙ„ÙŠØ³ Ù…Ø·Ø§Ø¨Ù‚ ÙÙ‚Ø·)
    function searchStudent() {
      const val = document.getElementById('searchInput').value.trim();
      const students = getStudents();
      const resultDiv = document.getElementById('searchResult');
      if (!val) {
        resultDiv.style.display = "none";
        renderTable();
        return;
      }
      // Ø¨Ø­Ø« ØªÙ‚Ø±ÙŠØ¨ÙŠ (Ø¬Ø²Ø¦ÙŠ)
      const matches = students.filter(s => s.name.includes(val));
      if (!matches.length) {
        resultDiv.textContent = "Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!";
        resultDiv.style.display = "block";
        renderTable();
      } else {
        resultDiv.textContent = `ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${matches.length} Ø·Ø§Ù„Ø¨/Ø© Ù…Ø·Ø§Ø¨Ù‚: "${matches.map(s=>s.name).join('", "')}"`;
        resultDiv.style.display = "block";
        renderTable(matches[0].name); // ÙŠÙ…ÙŠØ² Ø£ÙˆÙ„ Ù†ØªÙŠØ¬Ø©
        scrollToRow(matches[0].name);
      }
    }

    // Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    function showSuggestions() {
      const val = document.getElementById('searchInput').value.trim();
      const students = getStudents();
      const suggestions = document.getElementById('searchSuggestions');
      if (!val) {
        suggestions.style.display = "none";
        suggestions.innerHTML = "";
        return;
      }
      // Ø¨Ø­Ø« ØªÙ‚Ø±ÙŠØ¨ÙŠ (ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ)
      const filtered = students.filter(s => s.name.includes(val));
      if (!filtered.length) {
        suggestions.style.display = "none";
        suggestions.innerHTML = "";
        return;
      }
      suggestions.innerHTML = filtered.map((s, idx) =>
        `<li onclick="selectSuggestion('${s.name.replace(/'/g,"\\'")}')">${s.name}</li>`
      ).join('');
      suggestions.style.display = "block";
    }
    function selectSuggestion(name) {
      document.getElementById('searchInput').value = name;
      document.getElementById('searchSuggestions').style.display = "none";
      searchStudent();
    }
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¹Ù†Ø¯ ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ØªØ±ÙƒÙŠØ²
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.search-bar')) {
        document.getElementById('searchSuggestions').style.display = "none";
      }
    });

    // ØªÙ…Ø±ÙŠØ± Ù„Ù„ØµÙ Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø­Ø«
    function scrollToRow(name) {
      setTimeout(() => {
        const rows = document.querySelectorAll('#studentsTableBody tr');
        for (let row of rows) {
          if (row.classList.contains('highlight')) {
            row.scrollIntoView({ behavior: 'smooth', block: 'center' });
            break;
          }
        }
      }, 200);
    }

    // Ù†Ø§ÙØ°Ø© Ø§Ù„ÙØµÙˆÙ„
    let currentStudentIdx = null;
    function showSemestersModal(idx) {
      currentStudentIdx = idx;
      const students = getStudents();
      const s = students[idx];
      document.getElementById('modalStudentName').textContent = s.name;
      let semesters = s.semesters || Array(8).fill('');
      if (semesters.length < 8) semesters = semesters.concat(Array(8 - semesters.length).fill(''));
      let html = '';
      for (let i = 0; i < semesters.length; i++) {
        html += `<label>ÙØµÙ„ ${i+1}:</label>
          <input type="number" step="0.01" min="0" max="100" value="${semesters[i] !== '' ? semesters[i] : ''}" id="sem${i}" />
          <br>`;
      }
      document.getElementById('semestersInputs').innerHTML = html;
      updateFinalGpaText();
      document.getElementById('semestersModal').style.display = 'flex';
    }
    // Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ù„Ù„ÙØµÙˆÙ„
    function showSemestersModalByName(name) {
      const students = getStudents();
      const idx = students.findIndex(s => s.name === name);
      if (idx !== -1) showSemestersModal(idx);
    }
    function closeSemestersModal() {
      document.getElementById('semestersModal').style.display = 'none';
      currentStudentIdx = null;
    }
    document.addEventListener('input', function(e) {
      if (e.target && e.target.id.startsWith('sem')) {
        updateFinalGpaText();
      }
    });
    function updateFinalGpaText() {
      let sum = 0, count = 0;
      for (let i = 0; i < 8; i++) {
        const val = parseFloat(document.getElementById('sem'+i)?.value);
        if (!isNaN(val)) {
          sum += val;
          count++;
        }
      }
      const avg = count ? (sum / count).toFixed(2) : '';
      document.getElementById('finalGpaText').textContent = avg ? `Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ù…Ù‚ØªØ±Ø­: ${avg}` : '';
    }
    document.getElementById('semestersForm').onsubmit = function(e) {
      e.preventDefault();
      const students = getStudents();
      const semesters = [];
      let sum = 0, count = 0;
      for (let i = 0; i < 8; i++) {
        const val = parseFloat(document.getElementById('sem'+i).value);
        if (!isNaN(val)) {
          semesters.push(val);
          sum += val;
          count++;
        } else {
          semesters.push('');
        }
      }
      const avg = count ? (sum / count).toFixed(2) : '';
      students[currentStudentIdx].semesters = semesters;
      if (avg) students[currentStudentIdx].gpa = parseFloat(avg);
      setStudents(students);
      renderTable();
      renderStats();
      closeSemestersModal();
    };

    // ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø§Ù„Ø§Ø³Ù…
    function editStudentByName(name) {
      const students = getStudents();
      const idx = students.findIndex(s => s.name === name);
      if (idx === -1) return;
      const s = students[idx];
      const newName = prompt('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…:', s.name);
      if (newName === null) return;
      const newMajor = prompt('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ®ØµØµ:', s.major);
      if (newMajor === null) return;
      const newGpa = prompt('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:', s.gpa);
      if (newGpa === null || isNaN(parseFloat(newGpa))) return;
      students[idx] = { ...s, name: newName, major: newMajor, gpa: parseFloat(newGpa) };
      setStudents(students);
      renderTable();
      renderStats();
    }
    function deleteStudentByName(name) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨ØŸ')) return;
      const students = getStudents();
      const idx = students.findIndex(s => s.name === name);
      if (idx === -1) return;
      students.splice(idx, 1);
      setStudents(students);
      renderTable();
      renderStats();
    }

    // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
    function renderStats() {
      const students = getStudents();
      const count = students.length;
      const success = students.filter(s => s.gpa >= 50).length;
      const fail = count - success;
      const maxGpa = students.length ? Math.max(...students.map(s => s.gpa)) : 0;
      const minGpa = students.length ? Math.min(...students.map(s => s.gpa)) : 0;
      const avgGpa = count ? (students.reduce((a, s) => a + Number(s.gpa), 0) / count).toFixed(2) : 0;
      document.getElementById('statBar').innerHTML = `
        <div class="stat-box"><h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨</h3><p>${count}</p></div>
        <div class="stat-box"><h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø§Ø¬Ø­ÙŠÙ†</h3><p>${success}</p></div>
        <div class="stat-box"><h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø§Ø³Ø¨ÙŠÙ†</h3><p>${fail}</p></div>
        <div class="stat-box"><h3>Ø£Ø¹Ù„Ù‰ Ù…Ø¹Ø¯Ù„</h3><p>${maxGpa}</p></div>
        <div class="stat-box"><h3>Ø£Ù‚Ù„ Ù…Ø¹Ø¯Ù„</h3><p>${minGpa}</p></div>
        <div class="stat-box"><h3>Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¹Ø¯Ù„</h3><p>${avgGpa}</p></div>
      `;
    }
    // ØªØµØ¯ÙŠØ± ÙƒÙ€ CSV
    function exportCSV() {
      const students = getStudents();
      if (!students.length) return alert("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±!");
      let csv = "Ø§Ù„Ø±Ù‚Ù…;Ø§Ù„Ø§Ø³Ù…;Ø§Ù„ØªØ®ØµØµ;Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ;Ø§Ù„ÙØµÙˆÙ„\n";
      students.forEach((s, i) => {
        let sems = (s.semesters || []).map((v, idx) => `ÙØµÙ„${idx+1}:${v}`).join('|');
        csv += `${i+1};"${s.name}";"${s.major}";${s.gpa};"${sems}"\n`;
      });
      const blob = new Blob([new Uint8Array([0xEF,0xBB,0xBF]), csv], {type: "text/csv"});
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "students.csv";
      link.click();
    }
    // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø©
    window.addEventListener('focus', function() {
      renderTable();
      renderStats();
    });
    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.onload = function() {
      renderTable();
      renderStats();
    };
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
    document.getElementById('searchInput').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') searchStudent();
    });
  </script>
</body>
</html>